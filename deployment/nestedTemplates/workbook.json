{
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "CrossComponentCorrWorkbook",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "workbook",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
      }
    },
    "workbookSourceId": {
      "type": "string",
      "defaultValue": "/subscriptions/651dc44c-5d8e-48da-8cd3-cd79224ac290/resourcegroups/xstof-aicorr3/providers/microsoft.operationalinsights/workspaces/aicorr3-logic-loganalytics",
      "metadata": {
        "description": "The id of resource instance to which the workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "2be000cf-9391-40eb-9b18-fb1824bcd1a7",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "microsoft.insights/workbooks",
      "location": "[resourceGroup().location]",
      "apiVersion": "2018-06-17-preview",
      "dependsOn": [
      ],
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":\"{\\\"json\\\":\\\"## Cross Component Correlations\\\\n---\\\\n\\\\nThis workbook shows how custom correlations can be done across App Insights components and Log Analytics for: \\\\n- Azure Functions\\\\n- Azure Service Bus\\\\n- Logic Apps\\\\n\\\"}\",\"name\":\"text - 2\"},{\"type\":9,\"content\":\"{\\\"version\\\":\\\"KqlParameterItem/1.0\\\",\\\"parameters\\\":[{\\\"id\\\":\\\"95792dd9-c0cf-4c55-b321-79f146dd2e19\\\",\\\"version\\\":\\\"KqlParameterItem/1.0\\\",\\\"name\\\":\\\"appInsightsA\\\",\\\"label\\\":\\\"App Insights A\\\",\\\"type\\\":1,\\\"isRequired\\\":true,\\\"query\\\":\\\"print \\\\\\\"aicorr3-fn-appinsights-a\\\\\\\"\\\",\\\"isHiddenWhenLocked\\\":true,\\\"queryType\\\":0,\\\"resourceType\\\":\\\"microsoft.operationalinsights/workspaces\\\"},{\\\"id\\\":\\\"11cacc96-2843-41fd-9aae-32c400147752\\\",\\\"version\\\":\\\"KqlParameterItem/1.0\\\",\\\"name\\\":\\\"appInsightsB\\\",\\\"label\\\":\\\"App Insights B\\\",\\\"type\\\":1,\\\"isRequired\\\":true,\\\"query\\\":\\\"print \\\\\\\"aicorr3-fn-appinsights-b\\\\\\\"\\\",\\\"isHiddenWhenLocked\\\":true,\\\"queryType\\\":0,\\\"resourceType\\\":\\\"microsoft.operationalinsights/workspaces\\\"},{\\\"id\\\":\\\"ea8d8b97-25b8-4d92-acb5-4fcdea8d202a\\\",\\\"version\\\":\\\"KqlParameterItem/1.0\\\",\\\"name\\\":\\\"logAnalytics\\\",\\\"type\\\":1,\\\"isRequired\\\":true,\\\"query\\\":\\\"print \\\\\\\"aicorr3-logic-loganalytics\\\\\\\"\\\",\\\"isHiddenWhenLocked\\\":true,\\\"queryType\\\":0,\\\"resourceType\\\":\\\"microsoft.operationalinsights/workspaces\\\",\\\"label\\\":\\\"Log Analytics\\\"}],\\\"style\\\":\\\"above\\\",\\\"queryType\\\":0,\\\"resourceType\\\":\\\"microsoft.operationalinsights/workspaces\\\"}\",\"name\":\"parameters - 4\"},{\"type\":3,\"content\":\"{\\\"version\\\":\\\"KqlItem/1.0\\\",\\\"query\\\":\\\"( app('{appInsightsA}').requests | union app('{appInsightsB}').requests | union app('{appInsightsA}').dependencies | union app('{appInsightsB}').dependencies | union app('{appInsightsA}').pageViews | union app('{appInsightsB}').pageViews)\\\\r\\\\n| extend MyCustomCorrId = tostring(customDimensions.MyCustomCorrId)\\\\r\\\\n| project timestamp, MyCustomCorrId, operation_Name\\\\r\\\\n| where  MyCustomCorrId != ''\\\\r\\\\n| distinct MyCustomCorrId\\\\r\\\\n| project-rename ['My Custom Correlation Id'] = MyCustomCorrId\\\",\\\"size\\\":1,\\\"title\\\":\\\"Correlation Identifiers - seen in last 30 days\\\",\\\"timeContext\\\":{\\\"durationMs\\\":2592000000},\\\"exportFieldName\\\":\\\"My Custom Correlation Id\\\",\\\"exportParameterName\\\":\\\"corrid\\\",\\\"queryType\\\":0,\\\"resourceType\\\":\\\"microsoft.insights/components\\\",\\\"crossComponentResources\\\":[\\\"/subscriptions/651dc44c-5d8e-48da-8cd3-cd79224ac290/resourceGroups/xstof-aicorr3/providers/microsoft.insights/components/aicorr3-fn-appinsights-a\\\",\\\"/subscriptions/651dc44c-5d8e-48da-8cd3-cd79224ac290/resourceGroups/xstof-aicorr3/providers/microsoft.insights/components/aicorr3-fn-appinsights-b\\\"],\\\"visualization\\\":\\\"table\\\"}\",\"name\":\"query - 1\"},{\"type\":3,\"content\":\"{\\\"version\\\":\\\"KqlItem/1.0\\\",\\\"query\\\":\\\"let allApps = union app('{appInsightsA}').requests, app('{appInsightsB}').requests,\\\\r\\\\n              app('{appInsightsA}').dependencies, app('{appInsightsB}').dependencies,\\\\r\\\\n              app('{appInsightsA}').exceptions, app('{appInsightsB}').exceptions,\\\\r\\\\n              app('{appInsightsA}').traces, app('{appInsightsB}').traces,\\\\r\\\\n              app('{appInsightsA}').customEvents, app('{appInsightsB}').customEvents;\\\\r\\\\nlet LogicAppsDiagsRaw = \\\\r\\\\n  workspace('{logAnalytics}').AzureDiagnostics\\\\r\\\\n  | project-reorder startTime_t, status_s, OperationName, trackedProperties_Correlation_Context_s, trackedProperties_Request_Id_s, resource_runId_s;\\\\r\\\\nlet LogicAppsActionCompletedDiag = \\\\r\\\\n  LogicAppsDiagsRaw\\\\r\\\\n  | where OperationName == \\\\\\\"Microsoft.Logic/workflows/workflowActionCompleted\\\\\\\"\\\\r\\\\n  | parse kind = regex trackedProperties_Correlation_Context_s with * \\\\\\\"MyCustomCorrId=\\\\\\\" MyCustomCorrId:string\\\\r\\\\n  | extend id=strcat(resource_runId_s, Resource, OperationName)\\\\r\\\\n  | project-rename operation_ParentId=trackedProperties_Request_Id_s\\\\r\\\\n  | project-reorder  MyCustomCorrId, operation_ParentId, trackedProperties_Correlation_Context_s;\\\\r\\\\nlet MyCustomCorrIdMappingToResourceRunId = \\\\r\\\\n  LogicAppsActionCompletedDiag | where MyCustomCorrId != '' | distinct MyCustomCorrId, resource_runId_s, operation_ParentId;\\\\r\\\\nlet LogicAppsDiagsWithCustomCorrIdStamped = \\\\r\\\\n  LogicAppsDiagsRaw\\\\r\\\\n  | lookup kind=leftouter MyCustomCorrIdMappingToResourceRunId on resource_runId_s\\\\r\\\\n  | project-reorder MyCustomCorrId, resource_runId_s, trackedProperties_Correlation_Context_s, operation_ParentId, trackedProperties_Request_Id_s;\\\\r\\\\nlet AllLogicActionsWithFilledCorrelationIds =\\\\r\\\\n  LogicAppsDiagsWithCustomCorrIdStamped\\\\r\\\\n  | extend id=strcat(resource_runId_s, Resource, OperationName), timestamp=startTime_t\\\\r\\\\n  | project-reorder  MyCustomCorrId, operation_ParentId, resource_runId_s, trackedProperties_Correlation_Context_s;\\\\r\\\\nlet fullTreeView =\\\\r\\\\n  allApps \\\\r\\\\n  | extend MyCustomCorrId = tostring(customDimensions.MyCustomCorrId) \\\\r\\\\n  | extend message_or_name = strcat(message, name)\\\\r\\\\n  | union (\\\\r\\\\n     AllLogicActionsWithFilledCorrelationIds\\\\r\\\\n     | extend itemType = 'workflowAction'\\\\r\\\\n     | extend message_or_name = strcat(trim_start('Microsoft.Logic/workflows/workflow', OperationName), ' - ', Resource, ' ', error_message_s)\\\\r\\\\n  )\\\\r\\\\n  | where  MyCustomCorrId == \\\\\\\"{corrid}\\\\\\\"\\\\r\\\\n  | project-reorder timestamp, itemType, id, operation_ParentId, message_or_name, appId\\\\r\\\\n  | project-away problemId, handledAt, assembly, method, outerType, outerMessage, outerAssembly, outerMethod, innermostType, innermostMessage, innermostAssembly, innermostMethod, client_City, client_StateOrProvince, client_CountryOrRegion, client_Browser, cloud_RoleName, cloud_RoleInstance, client_Model, client_OS, operation_SyntheticSource, session_Id, user_Id, user_AuthenticatedId, user_AccountId, application_Version, client_Type, message, name\\\\r\\\\n  | order by timestamp asc;\\\\r\\\\nfullTreeView\\\\r\\\\n\\\",\\\"size\\\":0,\\\"title\\\":\\\"Cross Component Traces for selected correlation id\\\",\\\"timeContext\\\":{\\\"durationMs\\\":2592000000},\\\"queryType\\\":0,\\\"resourceType\\\":\\\"microsoft.insights/components\\\",\\\"crossComponentResources\\\":[\\\"/subscriptions/651dc44c-5d8e-48da-8cd3-cd79224ac290/resourceGroups/xstof-aicorr3/providers/microsoft.insights/components/aicorr3-fn-appinsights-b\\\",\\\"/subscriptions/651dc44c-5d8e-48da-8cd3-cd79224ac290/resourceGroups/xstof-aicorr3/providers/microsoft.insights/components/aicorr3-fn-appinsights-a\\\"],\\\"visualization\\\":\\\"table\\\",\\\"gridSettings\\\":{\\\"formatters\\\":[{\\\"columnMatch\\\":\\\"timestamp\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"itemType\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"operation_Id\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"operation_ParentId\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"message\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"name\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"appId\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"id\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"source\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"url\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"success\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"resultCode\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"duration\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"performanceBucket\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"customDimensions\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"customMeasurements\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"operation_Name\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"client_IP\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"appName\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"iKey\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"sdkVersion\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"itemId\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"itemCount\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"target\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"type\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"data\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"severityLevel\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"details\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"MyCustomCorrId\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"operation_SyntheticSource\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"session_Id\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"user_Id\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"user_AuthenticatedId\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"user_AccountId\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"application_Version\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"client_Type\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"client_Model\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"client_OS\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"client_City\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"client_StateOrProvince\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"client_CountryOrRegion\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"client_Browser\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"cloud_RoleName\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"cloud_RoleInstance\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"problemId\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"handledAt\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"assembly\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"method\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"outerType\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"outerMessage\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"outerAssembly\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"outerMethod\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"innermostType\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"innermostMessage\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"innermostAssembly\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}},{\\\"columnMatch\\\":\\\"innermostMethod\\\",\\\"formatter\\\":0,\\\"formatOptions\\\":{\\\"showIcon\\\":true}}],\\\"hierarchySettings\\\":{\\\"idColumn\\\":\\\"id\\\",\\\"parentColumn\\\":\\\"operation_ParentId\\\",\\\"treeType\\\":0,\\\"expanderColumn\\\":\\\"itemType\\\",\\\"expandTopLevel\\\":true},\\\"sortBy\\\":[{\\\"itemKey\\\":\\\"resource_actionName_s\\\",\\\"sortOrder\\\":1}],\\\"labelSettings\\\":[{\\\"columnId\\\":\\\"timestamp\\\",\\\"label\\\":\\\"timestamp\\\"},{\\\"columnId\\\":\\\"itemType\\\",\\\"label\\\":\\\"itemType\\\"},{\\\"columnId\\\":\\\"id\\\",\\\"label\\\":\\\"id\\\"},{\\\"columnId\\\":\\\"operation_ParentId\\\",\\\"label\\\":\\\"operation_ParentId\\\"},{\\\"columnId\\\":\\\"message_or_name\\\",\\\"label\\\":\\\"message_or_name\\\"},{\\\"columnId\\\":\\\"appId\\\",\\\"label\\\":\\\"appId\\\"},{\\\"columnId\\\":\\\"source\\\",\\\"label\\\":\\\"source\\\"},{\\\"columnId\\\":\\\"url\\\",\\\"label\\\":\\\"url\\\"},{\\\"columnId\\\":\\\"success\\\",\\\"label\\\":\\\"success\\\"},{\\\"columnId\\\":\\\"resultCode\\\",\\\"label\\\":\\\"resultCode\\\"},{\\\"columnId\\\":\\\"duration\\\",\\\"label\\\":\\\"duration\\\"},{\\\"columnId\\\":\\\"performanceBucket\\\",\\\"label\\\":\\\"performanceBucket\\\"},{\\\"columnId\\\":\\\"customDimensions\\\",\\\"label\\\":\\\"customDimensions\\\"},{\\\"columnId\\\":\\\"customMeasurements\\\",\\\"label\\\":\\\"customMeasurements\\\"},{\\\"columnId\\\":\\\"operation_Name\\\",\\\"label\\\":\\\"operation_Name\\\"},{\\\"columnId\\\":\\\"operation_Id\\\",\\\"label\\\":\\\"operation_Id\\\"},{\\\"columnId\\\":\\\"client_IP\\\",\\\"label\\\":\\\"client_IP\\\"},{\\\"columnId\\\":\\\"appName\\\",\\\"label\\\":\\\"appName\\\"},{\\\"columnId\\\":\\\"iKey\\\",\\\"label\\\":\\\"iKey\\\"},{\\\"columnId\\\":\\\"sdkVersion\\\",\\\"label\\\":\\\"sdkVersion\\\"},{\\\"columnId\\\":\\\"itemId\\\",\\\"label\\\":\\\"itemId\\\"},{\\\"columnId\\\":\\\"itemCount\\\",\\\"label\\\":\\\"itemCount\\\"},{\\\"columnId\\\":\\\"target\\\",\\\"label\\\":\\\"target\\\"},{\\\"columnId\\\":\\\"type\\\",\\\"label\\\":\\\"type\\\"},{\\\"columnId\\\":\\\"data\\\",\\\"label\\\":\\\"data\\\"},{\\\"columnId\\\":\\\"severityLevel\\\",\\\"label\\\":\\\"severityLevel\\\"},{\\\"columnId\\\":\\\"details\\\",\\\"label\\\":\\\"details\\\"},{\\\"columnId\\\":\\\"MyCustomCorrId\\\",\\\"label\\\":\\\"MyCustomCorrId\\\"},{\\\"columnId\\\":\\\"resource_runId_s\\\",\\\"label\\\":\\\"resource_runId_s\\\"},{\\\"columnId\\\":\\\"trackedProperties_Correlation_Context_s\\\",\\\"label\\\":\\\"trackedProperties_Correlation_Context_s\\\"},{\\\"columnId\\\":\\\"trackedProperties_Request_Id_s\\\",\\\"label\\\":\\\"trackedProperties_Request_Id_s\\\"},{\\\"columnId\\\":\\\"startTime_t\\\",\\\"label\\\":\\\"startTime_t\\\"},{\\\"columnId\\\":\\\"status_s\\\",\\\"label\\\":\\\"status_s\\\"},{\\\"columnId\\\":\\\"OperationName\\\",\\\"label\\\":\\\"OperationName\\\"},{\\\"columnId\\\":\\\"TenantId\\\",\\\"label\\\":\\\"TenantId\\\"},{\\\"columnId\\\":\\\"SourceSystem\\\",\\\"label\\\":\\\"SourceSystem\\\"},{\\\"columnId\\\":\\\"MG\\\",\\\"label\\\":\\\"MG\\\"},{\\\"columnId\\\":\\\"ManagementGroupName\\\",\\\"label\\\":\\\"ManagementGroupName\\\"},{\\\"columnId\\\":\\\"TimeGenerated\\\",\\\"label\\\":\\\"TimeGenerated\\\"},{\\\"columnId\\\":\\\"Computer\\\",\\\"label\\\":\\\"Computer\\\"},{\\\"columnId\\\":\\\"RawData\\\",\\\"label\\\":\\\"RawData\\\"},{\\\"columnId\\\":\\\"error_code_s\\\",\\\"label\\\":\\\"error_code_s\\\"},{\\\"columnId\\\":\\\"error_message_s\\\",\\\"label\\\":\\\"error_message_s\\\"},{\\\"columnId\\\":\\\"trackedProperties_Request_Context_s\\\",\\\"label\\\":\\\"trackedProperties_Request_Context_s\\\"},{\\\"columnId\\\":\\\"trackedProperties_customCorrelationId_s\\\",\\\"label\\\":\\\"trackedProperties_customCorrelationId_s\\\"},{\\\"columnId\\\":\\\"trackedProperties_traceparent_s\\\",\\\"label\\\":\\\"trackedProperties_traceparent_s\\\"},{\\\"columnId\\\":\\\"resource_triggerName_s\\\",\\\"label\\\":\\\"resource_triggerName_s\\\"},{\\\"columnId\\\":\\\"workflowId_s\\\",\\\"label\\\":\\\"workflowId_s\\\"},{\\\"columnId\\\":\\\"ResourceId\\\",\\\"label\\\":\\\"ResourceId\\\"},{\\\"columnId\\\":\\\"Category\\\",\\\"label\\\":\\\"Category\\\"},{\\\"columnId\\\":\\\"Level\\\",\\\"label\\\":\\\"Level\\\"},{\\\"columnId\\\":\\\"_schema_s\\\",\\\"label\\\":\\\"_schema_s\\\"},{\\\"columnId\\\":\\\"endTime_t\\\",\\\"label\\\":\\\"endTime_t\\\"},{\\\"columnId\\\":\\\"resource_subscriptionId_g\\\",\\\"label\\\":\\\"resource_subscriptionId_g\\\"},{\\\"columnId\\\":\\\"resource_resourceGroupName_s\\\",\\\"label\\\":\\\"resource_resourceGroupName_s\\\"},{\\\"columnId\\\":\\\"resource_workflowId_g\\\",\\\"label\\\":\\\"resource_workflowId_g\\\"},{\\\"columnId\\\":\\\"resource_workflowName_s\\\",\\\"label\\\":\\\"resource_workflowName_s\\\"},{\\\"columnId\\\":\\\"resource_originRunId_s\\\",\\\"label\\\":\\\"resource_originRunId_s\\\"},{\\\"columnId\\\":\\\"resource_location_s\\\",\\\"label\\\":\\\"resource_location_s\\\"},{\\\"columnId\\\":\\\"correlation_clientTrackingId_s\\\",\\\"label\\\":\\\"correlation_clientTrackingId_s\\\"},{\\\"columnId\\\":\\\"SubscriptionId\\\",\\\"label\\\":\\\"SubscriptionId\\\"},{\\\"columnId\\\":\\\"ResourceGroup\\\",\\\"label\\\":\\\"ResourceGroup\\\"},{\\\"columnId\\\":\\\"ResourceProvider\\\",\\\"label\\\":\\\"ResourceProvider\\\"},{\\\"columnId\\\":\\\"Resource\\\",\\\"label\\\":\\\"Resource\\\"},{\\\"columnId\\\":\\\"ResourceType\\\",\\\"label\\\":\\\"ResourceType\\\"},{\\\"columnId\\\":\\\"resource_actionName_s\\\",\\\"label\\\":\\\"resource_actionName_s\\\"},{\\\"columnId\\\":\\\"correlation_actionTrackingId_g\\\",\\\"label\\\":\\\"correlation_actionTrackingId_g\\\"},{\\\"columnId\\\":\\\"code_s\\\",\\\"label\\\":\\\"code_s\\\"},{\\\"columnId\\\":\\\"Type\\\",\\\"label\\\":\\\"Type\\\"},{\\\"columnId\\\":\\\"_ResourceId\\\",\\\"label\\\":\\\"_ResourceId\\\"}]},\\\"sortBy\\\":[{\\\"itemKey\\\":\\\"resource_actionName_s\\\",\\\"sortOrder\\\":1}]}\",\"conditionalVisibility\":{\"parameterName\":\"corrid\",\"comparison\":\"isNotEqualTo\",\"value\":\"\"},\"name\":\"query - 2\"},{\"type\":1,\"content\":\"{\\\"json\\\":\\\"Selected Correlation Id: {corrid}\\\"}\",\"name\":\"text - 3\"},{\"type\":3,\"content\":\"{\\\"version\\\":\\\"KqlItem/1.0\\\",\\\"query\\\":\\\"let LogicAppsDiagsRaw = \\\\r\\\\n  workspace('{logAnalytics}').AzureDiagnostics\\\\r\\\\n  | project-reorder startTime_t, status_s, OperationName, trackedProperties_Correlation_Context_s, trackedProperties_Request_Id_s, resource_runId_s;\\\\r\\\\nlet LogicAppsActionCompletedDiag = \\\\r\\\\n  LogicAppsDiagsRaw\\\\r\\\\n  | where OperationName == \\\\\\\"Microsoft.Logic/workflows/workflowActionCompleted\\\\\\\"\\\\r\\\\n  | parse kind = regex trackedProperties_Correlation_Context_s with * \\\\\\\"MyCustomCorrId=\\\\\\\" MyCustomCorrId:string\\\\r\\\\n  | extend id=strcat(resource_runId_s, Resource, OperationName)\\\\r\\\\n  | project-rename operation_ParentId=trackedProperties_Request_Id_s\\\\r\\\\n  | project-reorder  MyCustomCorrId, operation_ParentId, trackedProperties_Correlation_Context_s;\\\\r\\\\nlet MyCustomCorrIdMappingToResourceRunId = \\\\r\\\\n  LogicAppsActionCompletedDiag | where MyCustomCorrId != '' | distinct MyCustomCorrId, resource_runId_s, operation_ParentId;\\\\r\\\\nlet LogicAppsDiagsWithCustomCorrIdStamped = \\\\r\\\\n  LogicAppsDiagsRaw\\\\r\\\\n  | lookup kind=leftouter MyCustomCorrIdMappingToResourceRunId on resource_runId_s\\\\r\\\\n  | project-reorder MyCustomCorrId, resource_runId_s, trackedProperties_Correlation_Context_s, operation_ParentId, trackedProperties_Request_Id_s;\\\\r\\\\nlet AllLogicActionsWithFilledCorrelationIds =\\\\r\\\\n  LogicAppsDiagsWithCustomCorrIdStamped\\\\r\\\\n  | extend id=strcat(resource_runId_s, Resource, OperationName), timestamp=startTime_t\\\\r\\\\n  | project-reorder  MyCustomCorrId, operation_ParentId, resource_runId_s, trackedProperties_Correlation_Context_s;\\\\r\\\\n//AllLogicActionsWithFilledCorrelationIds | extend itemType = 'workflowAction' | where MyCustomCorrId == \\\\\\\"{corrid}\\\\\\\"\\\\r\\\\nLogicAppsDiagsRaw\\\",\\\"size\\\":0,\\\"queryType\\\":0,\\\"resourceType\\\":\\\"microsoft.operationalinsights/workspaces\\\",\\\"crossComponentResources\\\":[\\\"/subscriptions/651dc44c-5d8e-48da-8cd3-cd79224ac290/resourceGroups/xstof-aicorr3/providers/Microsoft.OperationalInsights/workspaces/aicorr3-logic-loganalytics\\\",\\\"/subscriptions/651dc44c-5d8e-48da-8cd3-cd79224ac290/resourcegroups/xstof-aicorr3/providers/microsoft.operationalinsights/workspaces/aicorr3-logic-loganalytics\\\"],\\\"visualization\\\":\\\"table\\\",\\\"gridSettings\\\":{\\\"sortBy\\\":[{\\\"itemKey\\\":\\\"resource_runId_s\\\",\\\"sortOrder\\\":1}],\\\"labelSettings\\\":[{\\\"columnId\\\":\\\"startTime_t\\\",\\\"label\\\":\\\"startTime_t\\\"},{\\\"columnId\\\":\\\"status_s\\\",\\\"label\\\":\\\"status_s\\\"},{\\\"columnId\\\":\\\"OperationName\\\",\\\"label\\\":\\\"OperationName\\\"},{\\\"columnId\\\":\\\"trackedProperties_Correlation_Context_s\\\",\\\"label\\\":\\\"trackedProperties_Correlation_Context_s\\\"},{\\\"columnId\\\":\\\"trackedProperties_Request_Id_s\\\",\\\"label\\\":\\\"trackedProperties_Request_Id_s\\\"},{\\\"columnId\\\":\\\"resource_runId_s\\\",\\\"label\\\":\\\"resource_runId_s\\\"},{\\\"columnId\\\":\\\"TenantId\\\",\\\"label\\\":\\\"TenantId\\\"},{\\\"columnId\\\":\\\"SourceSystem\\\",\\\"label\\\":\\\"SourceSystem\\\"},{\\\"columnId\\\":\\\"MG\\\",\\\"label\\\":\\\"MG\\\"},{\\\"columnId\\\":\\\"ManagementGroupName\\\",\\\"label\\\":\\\"ManagementGroupName\\\"},{\\\"columnId\\\":\\\"TimeGenerated\\\",\\\"label\\\":\\\"TimeGenerated\\\"},{\\\"columnId\\\":\\\"Computer\\\",\\\"label\\\":\\\"Computer\\\"},{\\\"columnId\\\":\\\"RawData\\\",\\\"label\\\":\\\"RawData\\\"},{\\\"columnId\\\":\\\"error_code_s\\\",\\\"label\\\":\\\"error_code_s\\\"},{\\\"columnId\\\":\\\"error_message_s\\\",\\\"label\\\":\\\"error_message_s\\\"},{\\\"columnId\\\":\\\"trackedProperties_Request_Context_s\\\",\\\"label\\\":\\\"trackedProperties_Request_Context_s\\\"},{\\\"columnId\\\":\\\"trackedProperties_customCorrelationId_s\\\",\\\"label\\\":\\\"trackedProperties_customCorrelationId_s\\\"},{\\\"columnId\\\":\\\"trackedProperties_traceparent_s\\\",\\\"label\\\":\\\"trackedProperties_traceparent_s\\\"},{\\\"columnId\\\":\\\"resource_triggerName_s\\\",\\\"label\\\":\\\"resource_triggerName_s\\\"},{\\\"columnId\\\":\\\"workflowId_s\\\",\\\"label\\\":\\\"workflowId_s\\\"},{\\\"columnId\\\":\\\"ResourceId\\\",\\\"label\\\":\\\"ResourceId\\\"},{\\\"columnId\\\":\\\"Category\\\",\\\"label\\\":\\\"Category\\\"},{\\\"columnId\\\":\\\"Level\\\",\\\"label\\\":\\\"Level\\\"},{\\\"columnId\\\":\\\"_schema_s\\\",\\\"label\\\":\\\"_schema_s\\\"},{\\\"columnId\\\":\\\"endTime_t\\\",\\\"label\\\":\\\"endTime_t\\\"},{\\\"columnId\\\":\\\"resource_subscriptionId_g\\\",\\\"label\\\":\\\"resource_subscriptionId_g\\\"},{\\\"columnId\\\":\\\"resource_resourceGroupName_s\\\",\\\"label\\\":\\\"resource_resourceGroupName_s\\\"},{\\\"columnId\\\":\\\"resource_workflowId_g\\\",\\\"label\\\":\\\"resource_workflowId_g\\\"},{\\\"columnId\\\":\\\"resource_workflowName_s\\\",\\\"label\\\":\\\"resource_workflowName_s\\\"},{\\\"columnId\\\":\\\"resource_originRunId_s\\\",\\\"label\\\":\\\"resource_originRunId_s\\\"},{\\\"columnId\\\":\\\"resource_location_s\\\",\\\"label\\\":\\\"resource_location_s\\\"},{\\\"columnId\\\":\\\"correlation_clientTrackingId_s\\\",\\\"label\\\":\\\"correlation_clientTrackingId_s\\\"},{\\\"columnId\\\":\\\"SubscriptionId\\\",\\\"label\\\":\\\"SubscriptionId\\\"},{\\\"columnId\\\":\\\"ResourceGroup\\\",\\\"label\\\":\\\"ResourceGroup\\\"},{\\\"columnId\\\":\\\"ResourceProvider\\\",\\\"label\\\":\\\"ResourceProvider\\\"},{\\\"columnId\\\":\\\"Resource\\\",\\\"label\\\":\\\"Resource\\\"},{\\\"columnId\\\":\\\"ResourceType\\\",\\\"label\\\":\\\"ResourceType\\\"},{\\\"columnId\\\":\\\"resource_actionName_s\\\",\\\"label\\\":\\\"resource_actionName_s\\\"},{\\\"columnId\\\":\\\"correlation_actionTrackingId_g\\\",\\\"label\\\":\\\"correlation_actionTrackingId_g\\\"},{\\\"columnId\\\":\\\"code_s\\\",\\\"label\\\":\\\"code_s\\\"},{\\\"columnId\\\":\\\"Type\\\",\\\"label\\\":\\\"Type\\\"},{\\\"columnId\\\":\\\"_ResourceId\\\",\\\"label\\\":\\\"_ResourceId\\\"}]},\\\"sortBy\\\":[{\\\"itemKey\\\":\\\"resource_runId_s\\\",\\\"sortOrder\\\":1}]}\",\"name\":\"query - 5\"}],\"isLocked\":false}",
        "version": "1.0",
        "sourceId": "[parameters('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  },
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
}